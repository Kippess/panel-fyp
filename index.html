<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Tabla Anual FYP</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/x-icon" href="logo.jpg">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>document.write('<script src="data.js?v=' + new Date().getTime() + '"><\/script>');</script>

<style>
  :root {
    --primary: #009640; 
    --secondary: #f39c12; 
    --dark-bg: #1a1a1a;
    --card-bg: rgba(255, 255, 255, 0.07);
    --text-color: #ecf0f1;
  }

  body {
    font-family: 'Montserrat', sans-serif;
    background: radial-gradient(circle at center, #2c3e50, #000000);
    color: var(--text-color);
    margin: 0; padding: 20px;
    min-height: 100vh;
  }

  header { text-align: center; margin-bottom: 30px; animation: fadeIn 1s ease; }
  .logo-img { width: 120px; height: auto; border-radius: 50%; border: 3px solid var(--secondary); box-shadow: 0 0 20px rgba(243, 156, 18, 0.4); margin-bottom: 10px; }
  h1 { text-transform: uppercase; font-weight: 900; font-size: 2.2em; margin: 10px 0; background: linear-gradient(to right, var(--secondary), #f1c40f); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: 2px; }

  .countdown-box { background: rgba(0, 150, 64, 0.2); border: 1px solid var(--primary); padding: 10px; border-radius: 10px; text-align: center; margin-bottom: 30px; font-weight: bold; color: #2ecc71; }

  .grid-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
  .card { background: var(--card-bg); padding: 20px; border-radius: 20px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 10px 30px rgba(0,0,0,0.5); transition: transform 0.3s; }
  .card:hover { transform: translateY(-5px); }
  
  .champion-card { background: linear-gradient(135deg, rgba(243, 156, 18, 0.1), rgba(0,0,0,0.8)); border: 2px solid var(--secondary); text-align: center; position: relative; overflow: hidden; }
  .champion-card::before { content: "üëë VIGENTE CAMPE√ìN"; position: absolute; top: 10px; right: -30px; background: var(--secondary); color: black; padding: 5px 30px; transform: rotate(45deg); font-weight: bold; font-size: 0.8em; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }
  .champion-img { width: 100%; max-height: 250px; object-fit: cover; object-position: top; border-radius: 15px; border: 2px solid rgba(255,215,0,0.3); margin-bottom: 10px; }

  .btn-vote { display: block; width: 100%; text-align: center; background: linear-gradient(45deg, var(--primary), #27ae60); color: white; padding: 15px 0; border-radius: 10px; text-decoration: none; font-weight: bold; text-transform: uppercase; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3); }

  .top-list .player-row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
  .points { color: var(--secondary); font-weight: bold; }

  table { width: 100%; border-collapse: collapse; margin-top: 10px; }
  th { background: rgba(0, 150, 64, 0.3); padding: 12px; font-size: 0.8em; }
  td { padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); text-align: center; }
  
  .history-scroll { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 10px; }
  .match-mini { min-width: 180px; background: rgba(0,0,0,0.4); padding: 15px; border-radius: 10px; border-left: 3px solid var(--secondary); }

  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
</style>
</head>
<body>

<header>
  <img src="logo.jpg" alt="Escudo FYP" class="logo-img">
  <h1>Tabla Anual FYP</h1>
</header>

<div class="countdown-box" id="countdown">‚öΩ Pr√≥ximo Partido: Calculando...</div>

<a href="TU_LINK_DE_GOOGLE_FORMS" target="_blank" class="btn-vote">üó≥Ô∏è VOTAR MVP AHORA</a>

<div class="grid-container">
  <div class="card champion-card">
    <h3>üèÜ CAMPE√ìN 2025</h3>
    <img src="campeon.jpg" alt="Campe√≥n Vigente" class="champion-img">
    <h2 style="margin:5px 0; color:var(--secondary)">LA DEMENCIA</h2>
    <p style="font-size:0.9em; opacity:0.8">Defender√° el t√≠tulo esta temporada.</p>
  </div>

  <div class="card">
    <h3>üìä Rendimiento Actual</h3>
    <canvas id="mvpChart"></canvas>
  </div>

  <div class="card">
    <h3>üî• TOP 5 (2026)</h3>
    <div id="top5List" class="top-list"></div>
  </div>
</div>

<div class="card" style="margin-bottom: 20px;">
  <h3>üìÖ Historial de Partidos</h3>
  <div id="historyContainer" class="history-scroll"></div>
</div>

<div class="card">
  <div style="overflow-x:auto;">
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Jugador</th>
          <th>PJ</th>
          <th>MVP</th>
          <th>Pts</th>
        </tr>
      </thead>
      <tbody id="mainTable"></tbody>
    </table>
  </div>
</div>

<script>
  function updateCountdown() {
    const now = new Date();
    const nextSunday = new Date();
    nextSunday.setDate(now.getDate() + (7 - now.getDay()) % 7);
    nextSunday.setHours(20, 0, 0, 0); // Actualizado a las 20:00 hs
    
    if (now > nextSunday) nextSunday.setDate(nextSunday.getDate() + 7);

    const diff = nextSunday - now;
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    
    const text = days > 0 
      ? `Faltan ${days} d√≠as y ${hours} horas para el Domingo` 
      : `¬°HOY SE JUEGA! ‚öΩ Faltan ${hours} horas`;
      
    document.getElementById("countdown").innerText = text;
  }
  updateCountdown();

  if(typeof PLAYERS !== 'undefined') {
    const data = Object.entries(PLAYERS).map(([name, d]) => {
      const asistencia = TOTAL_MATCHES ? (d.matches / TOTAL_MATCHES) * 100 : 0;
      const score = (d.mvp * 15) + (d.matches * 5) + (asistencia * 0.1);
      return { name, ...d, asistencia, score };
    }).sort((a, b) => b.score - a.score);

    data.slice(0, 5).forEach((p, i) => {
      const medals = ["ü•á", "ü•à", "ü•â", "4¬∞", "5¬∞"];
      document.getElementById("top5List").innerHTML += `
        <div class="player-row">
          <span>${medals[i]} ${p.name}</span>
          <span class="points">${p.score.toFixed(0)}</span>
        </div>`;
    });

    if(typeof MATCH_HISTORY !== 'undefined'){
      MATCH_HISTORY.forEach(m => {
        document.getElementById("historyContainer").innerHTML += `
          <div class="match-mini">
            <div style="color:var(--secondary); font-weight:bold; font-size:0.8em">${m.fecha}</div>
            <div>${m.resultado}</div>
            <div style="margin-top:5px; font-size:0.9em">üåü MVP: ${m.mvp}</div>
          </div>`;
      });
    }

    data.forEach((p, i) => {
      document.getElementById("mainTable").innerHTML += `
        <tr>
          <td>${i+1}</td>
          <td style="text-align:left; font-weight:bold">${p.name}</td>
          <td>${p.matches}</td>
          <td>${p.mvp}</td>
          <td style="color:var(--secondary)">${p.score.toFixed(1)}</td>
        </tr>`;
    });

    new Chart(document.getElementById('mvpChart'), {
      type: 'doughnut',
      data: {
        labels: data.slice(0,5).map(p => p.name),
        datasets: [{
          data: data.slice(0,5).map(p => p.mvp),
          backgroundColor: ['#009640', '#f39c12', '#e74c3c', '#3498db', '#9b59b6'],
          borderWidth: 0
        }]
      },
      options: { plugins: { legend: { position: 'right', labels: { color: 'white', boxWidth: 10 } } } }
    });
  }
</script>
</body>
</html>
